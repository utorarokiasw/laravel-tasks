name: Deploy Resource to Azure
on:
  workflow_dispatch:
  
permissions:
  id-token: write # Required for requesting the JWT
  contents: read  # Required for actions/checkout

jobs:
  create-resource:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Azure Login
        uses: azure/login@v2
        with:
          client-id: ${{ secrets.AZURE_CLIENT_ID }}
          tenant-id: ${{ secrets.AZURE_TENANT_ID }}
          subscription-id: ${{ secrets.AZURE_SUBSCRIPTION_ID }}

      - name: Create Storage Account
        uses: azure/cli@v2
        with:
          inlineScript: |
            # Get current date in YYYY-MM-DD format
            CURRENT_DATE=$(date +%Y-%m-%d)
            
            # Replace 'my-resource-group' with your actual RG name
            az storage account create \
              --name "uniquestorage$(date +%s)" \
              --resource-group "N278-EIS-AROKIASW-RG1" \
              --location "eastus" \
              --sku Standard_LRS \
              --tags "CreatedOn=$CURRENT_DATE" "CreatedBy=arokiasw"
